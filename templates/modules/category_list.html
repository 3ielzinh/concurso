{% extends 'base.html' %}

{% block title %}Categorias - MicroSaaS Concursos{% endblock %}

{% block content %}
<div class="d-sm-flex align-items-center justify-content-between mb-4">
    <h1 class="h3 mb-0 text-gray-800">
        <i class="bi bi-book me-2"></i> Categorias de Estudo
    </h1>
</div>

{% if not user.is_premium %}
<div class="alert alert-info">
    <i class="bi bi-info-circle me-2"></i>
    <strong>Plano Gratuito:</strong> Você tem acesso limitado a algumas categorias. 
    <a href="{% url 'subscriptions:plans' %}" class="alert-link">Faça upgrade para acessar todas!</a>
</div>
{% endif %}

<div class="row">
    {% for category in categories %}
    <div class="col-xl-3 col-md-4 col-sm-6 mb-4">
        <div class="card h-100 hover-shadow" style="transition: all 0.3s;">
            <div class="card-body text-center {% if category.background_image %}category-card-with-bg{% endif %}">
                {% if category.background_image %}
                <div class="category-card-bg" style="background-image: url('{{ category.background_image }}');"></div>
                <div class="category-card-overlay"></div>
                {% endif %}
                <div class="category-card-content">
                <div class="mb-3">
                    <i class="bi bi-{{ category.icon }} text-{{ category.color }}" style="font-size: 3rem;"></i>
                </div>
                <h5 class="card-title">{{ category.get_name_display }}</h5>
                <p class="card-text text-muted small">
                    {{ category.description|truncatewords:15|default:"Explore os módulos desta categoria" }}
                </p>
                {% if category.is_premium %}
                <span class="badge badge-premium mb-2">
                    <i class="bi bi-star-fill me-1"></i> Premium
                </span>
                {% endif %}
                </div>
            </div>
            <div class="card-footer border-top-0" style="background-color: var(--bs-body-bg);">
                <a href="{% url 'modules:module_list' category.name %}" class="btn btn-{{ category.color }} w-100">
                    <i class="bi bi-arrow-right-circle me-2"></i> Ver Módulos
                </a>
            </div>
        </div>
    </div>
    {% empty %}
    <div class="col-12">
        <div class="alert alert-warning text-center">
            <i class="bi bi-exclamation-triangle me-2"></i>
            Nenhuma categoria disponível no momento.
        </div>
    </div>
    {% endfor %}
</div>
{% endblock %}

{% block extra_css %}
<style>
    .hover-shadow:hover {
        transform: translateY(-5px);
        box-shadow: 0 0.5rem 1.75rem 0 rgba(58, 59, 69, 0.3) !important;
    }
    
    .category-card-with-bg {
        position: relative;
        overflow: hidden;
    }

    .category-card-bg {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-size: cover;
        background-position: center;
        filter: blur(8px);
        transform: scale(1.1);
        z-index: 1;
    }

    .category-card-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(255, 255, 255, 0.85);
        z-index: 2;
    }

    body.dark-mode .category-card-overlay {
        background: rgba(13, 17, 23, 0.85);
    }

    .category-card-content {
        position: relative;
        z-index: 3;
    }
    
    .card-footer {
        background-color: var(--bs-body-bg);
    }
    
    body.dark-mode .card-footer {
        background-color: #1a1d23 !important;
        color: #e6edf3 !important;
    }
    
    body.dark-mode .card-title {
        color: #e6edf3 !important;
    }
    
    body.dark-mode .text-muted {
        color: #8b949e !important;
    }
    
    body.dark-mode .category-card-content {
        color: #e6edf3 !important;
    }
</style>
{% endblock %}
